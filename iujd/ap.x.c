#if 0
	shc Version 4.0.1, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f ap 
#endif

static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\012"
#define      lsto_z	1
#define      lsto	((&data[1]))
	"\070"
#define      pswd_z	256
#define      pswd	((&data[26]))
	"\130\072\137\225\252\032\237\321\370\204\263\012\124\273\077\144"
	"\002\153\161\305\370\337\171\226\045\005\153\166\040\273\056\075"
	"\226\270\245\226\325\032\331\042\367\173\346\373\300\065\051\047"
	"\345\341\040\324\053\144\156\121\151\331\310\212\224\367\307\053"
	"\257\155\301\204\207\233\247\176\027\216\172\327\303\244\377\251"
	"\205\040\175\261\205\354\003\356\305\314\171\131\303\101\205\162"
	"\256\107\367\065\342\237\264\372\055\057\322\361\323\321\233\131"
	"\362\031\012\167\005\016\146\312\332\337\044\235\040\252\020\317"
	"\361\010\005\324\250\271\316\325\351\240\307\275\162\142\026\144"
	"\173\041\334\200\057\102\113\012\041\160\247\102\032\270\021\014"
	"\300\026\340\150\320\256\076\271\117\006\167\301\150\215\046\344"
	"\256\002\145\336\104\260\350\146\041\220\251\073\111\272\110\012"
	"\321\050\162\242\327\261\134\046\267\323\347\040\140\016\004\017"
	"\020\151\356\125\032\326\273\073\147\144\167\260\037\277\272\361"
	"\347\055\223\276\337\360\344\227\303\314\267\044\332\273\063\353"
	"\045\041\100\077\370\374\173\140\141\362\020\201\261\313\162\231"
	"\371\006\130\330\366\075\157\272\011\046\336\344\342\022\317\007"
	"\064\020\107\054\014\302\214\156\316\340\377\061\340\142\232\071"
	"\235\371\316\107\023\156\030\014\362\314\027\107\207\126\253\212"
	"\302\035"
#define      inlo_z	3
#define      inlo	((&data[308]))
	"\247\170\267"
#define      opts_z	1
#define      opts	((&data[311]))
	"\117"
#define      msg2_z	19
#define      msg2	((&data[313]))
	"\212\014\237\007\375\071\022\004\143\357\226\131\145\235\070\201"
	"\145\277\072\045\264\226\303\121"
#define      chk1_z	22
#define      chk1	((&data[339]))
	"\244\000\261\206\203\233\054\201\142\344\125\122\003\077\026\120"
	"\217\230\346\255\121\172\233\263\113\261\363\175"
#define      text_z	6065
#define      text	((&data[712]))
	"\037\346\220\342\003\340\235\000\251\357\314\123\102\310\336\366"
	"\137\241\110\360\064\340\224\064\222\106\050\020\016\143\025\056"
	"\111\246\020\115\206\255\115\060\235\031\204\337\342\142\326\102"
	"\004\036\062\070\377\307\155\221\015\225\241\034\371\267\112\102"
	"\136\132\220\344\007\335\025\245\367\231\204\332\373\132\034\000"
	"\171\117\070\170\026\245\011\044\073\253\100\064\143\212\167\301"
	"\345\010\245\355\345\273\222\335\124\027\267\120\162\324\120\353"
	"\043\211\143\072\056\155\136\152\030\237\237\173\052\027\074\017"
	"\037\342\374\005\235\217\342\362\247\232\102\031\157\222\005\222"
	"\033\151\314\112\327\053\265\357\312\124\153\364\153\250\004\213"
	"\213\000\220\050\220\163\033\067\015\135\121\174\360\127\017\014"
	"\300\334\126\227\007\014\207\321\140\363\306\314\233\312\130\046"
	"\313\350\117\133\133\152\223\151\310\344\346\270\074\365\304\375"
	"\321\033\225\331\050\034\253\211\017\161\126\253\074\256\322\007"
	"\226\041\143\361\214\366\133\124\333\101\015\027\066\322\024\010"
	"\356\251\341\026\306\214\237\326\376\365\201\072\244\123\101\072"
	"\165\244\054\002\233\207\127\166\310\144\216\376\067\242\007\046"
	"\114\350\075\022\164\334\350\162\322\152\255\166\276\356\261\063"
	"\223\335\065\056\144\214\245\055\361\063\053\050\325\063\117\042"
	"\033\214\064\220\151\035\003\074\210\260\262\106\237\144\172\063"
	"\101\257\141\246\074\007\323\055\072\377\126\020\062\246\062\116"
	"\062\147\336\233\205\342\327\015\222\212\124\062\174\160\353\206"
	"\325\265\103\231\273\061\074\222\220\012\325\237\362\377\127\073"
	"\351\221\302\205\302\051\265\325\151\025\037\243\021\173\310\060"
	"\014\067\072\044\032\120\136\255\300\332\247\260\074\142\344\373"
	"\324\142\163\341\006\160\331\333\262\207\332\247\207\074\204\377"
	"\052\133\210\276\341\343\037\272\351\350\301\144\307\206\144\147"
	"\332\132\221\023\004\070\026\023\120\313\246\144\167\143\033\321"
	"\016\367\211\216\323\037\027\070\313\005\076\362\067\345\354\231"
	"\276\043\212\237\060\347\032\115\227\072\116\165\354\274\216\357"
	"\032\145\361\060\357\030\377\021\111\032\370\273\113\213\334\307"
	"\204\001\226\150\112\310\172\162\175\047\344\213\301\233\247\021"
	"\206\153\151\172\077\164\125\131\102\002\132\137\271\161\103\173"
	"\033\272\010\360\222\130\013\253\045\306\216\271\031\004\223\222"
	"\025\021\003\104\261\047\345\213\241\035\200\301\207\244\323\106"
	"\111\012\073\310\040\023\117\237\140\265\035\313\305\035\227\353"
	"\307\121\340\040\220\026\337\007\036\101\031\160\153\143\064\117"
	"\307\115\106\147\241\167\100\005\342\257\057\126\243\172\042\002"
	"\174\016\061\243\076\117\041\247\015\236\177\073\231\304\336\023"
	"\115\064\200\117\220\251\045\304\212\204\011\000\023\014\025\201"
	"\115\103\167\200\341\145\101\034\155\220\014\223\163\377\253\277"
	"\340\176\235\202\345\064\236\035\035\046\265\252\216\014\013\045"
	"\322\204\177\230\132\061\144\263\314\220\176\160\372\376\355\361"
	"\244\372\022\102\140\000\161\172\034\105\337\145\223\140\244\165"
	"\172\345\266\056\156\371\100\236\117\006\162\273\166\346\275\164"
	"\273\206\165\273\247\063\117\214\020\162\376\145\210\104\115\151"
	"\004\255\333\173\074\234\346\000\017\301\151\221\334\052\156\104"
	"\271\231\212\273\101\162\177\153\351\303\224\213\246\246\102\224"
	"\111\340\177\256\345\113\133\121\174\364\304\123\260\142\324\224"
	"\340\203\367\036\073\302\131\305\026\314\217\136\000\107\325\206"
	"\223\306\306\265\321\252\140\037\250\242\315\170\174\023\353\006"
	"\105\250\377\346\343\117\157\075\075\003\244\025\150\034\003\071"
	"\061\104\165\323\074\031\056\205\220\200\316\165\311\312\140\230"
	"\247\113\301\117\112\057\054\312\346\115\250\275\361\304\056\315"
	"\167\254\237\026\331\352\220\121\327\276\330\163\325\050\110\007"
	"\000\224\056\234\164\010\055\277\164\356\235\306\004\120\070\145"
	"\335\055\227\007\044\127\105\260\167\143\364\314\057\071\164\341"
	"\265\254\201\346\352\272\144\052\120\346\354\160\047\156\374\231"
	"\000\017\102\204\247\320\241\161\056\363\344\327\233\153\334\322"
	"\100\140\256\227\222\204\360\343\250\030\255\146\353\005\244\334"
	"\260\000\343\373\217\366\011\236\041\130\064\176\361\322\017\161"
	"\263\217\230\307\252\372\063\142\241\315\154\175\355\362\205\210"
	"\357\135\327\172\316\015\046\262\260\334\063\377\077\365\363\363"
	"\361\023\164\152\227\163\362\345\172\366\360\124\362\027\343\336"
	"\340\377\242\155\070\241\066\235\041\277\032\001\334\103\247\154"
	"\041\347\362\152\342\123\317\236\353\225\343\234\175\054\012\054"
	"\264\057\211\010\007\012\245\360\065\105\126\157\363\237\336\217"
	"\361\104\363\146\321\146\145\351\302\014\245\014\373\254\057\371"
	"\051\111\206\364\055\142\123\030\207\300\103\245\004\121\041\206"
	"\172\044\242\100\110\304\061\003\052\211\120\123\057\274\114\070"
	"\143\041\361\243\205\244\272\377\261\237\167\251\110\253\355\244"
	"\050\344\330\357\342\312\141\265\265\252\270\250\024\226\232\072"
	"\301\113\265\140\011\242\237\160\161\374\227\112\207\315\164\346"
	"\074\164\366\160\074\050\314\121\247\034\212\027\073\220\075\377"
	"\327\361\265\310\342\246\330\130\201\014\224\046\024\244\052\305"
	"\077\330\320\237\052\352\371\072\102\112\123\155\041\037\054\140"
	"\077\221\271\367\132\010\075\230\172\011\246\101\350\270\046\373"
	"\141\244\151\354\006\216\052\132\004\254\360\203\340\137\237\332"
	"\337\371\370\053\012\225\377\363\117\172\247\361\315\261\044\104"
	"\275\245\056\251\253\035\375\336\343\153\341\223\246\220\046\061"
	"\210\227\133\271\147\155\256\212\332\177\143\127\112\317\305\240"
	"\313\021\150\142\274\152\247\202\031\363\023\372\051\041\043\064"
	"\157\044\313\140\101\242\235\352\262\021\101\202\132\042\021\362"
	"\240\334\006\071\150\001\035\054\265\315\153\055\326\173\006\112"
	"\141\204\055\354\061\341\117\272\376\147\264\367\067\171\036\035"
	"\066\273\272\111\245\332\340\341\235\032\006\126\032\363\246\016"
	"\235\115\133\312\023\045\306\271\355\377\263\145\355\321\276\046"
	"\267\250\003\031\206\371\066\226\004\155\233\172\107\055\164\057"
	"\373\010\262\245\247\041\101\352\344\237\123\101\373\243\155\072"
	"\002\233\067\305\057\275\304\073\220\075\360\044\337\361\266\213"
	"\121\015\354\240\054\122\350\252\220\345\071\116\367\242\156\313"
	"\054\365\301\071\327\034\243\313\232\035\247\103\265\051\377\005"
	"\136\100\343\006\325\126\067\135\010\215\046\116\051\346\220\323"
	"\331\114\167\250\056\276\254\313\136\036\075\315\264\225\345\333"
	"\065\121\032\203\300\225\176\205\211\067\022\062\163\017\046\015"
	"\052\036\364\257\105\070\062\350\100\055\374\261\151\227\302\125"
	"\250\037\377\354\106\024\301\074\330\004\360\205\375\326\275\347"
	"\131\016\170\022\045\267\106\010\313\145\125\027\264\040\000\201"
	"\041\045\016\312\327\305\323\237\143\233\340\110\336\221\364\104"
	"\062\337\362\116\316\171\161\067\111\063\373\146\127\171\121\241"
	"\305\205\270\327\102\212\355\051\124\137\323\241\151\014\042\175"
	"\345\364\063\350\115\230\222\133\320\103\126\323\051\035\256\054"
	"\105\235\363\144\273\227\317\262\164\066\303\022\000\047\127\144"
	"\350\041\003\072\316\350\145\211\235\334\004\152\113\005\014\135"
	"\141\167\347\066\147\366\056\065\022\044\103\167\107\255\166\117"
	"\112\131\234\230\331\203\260\241\074\134\177\216\210\264\010\360"
	"\075\135\102\130\275\066\277\132\115\174\112\014\071\040\257\376"
	"\377\377\343\330\265\127\020\264\336\145\327\242\324\056\336\111"
	"\110\272\070\047\252\302\173\002\343\057\120\374\135\302\053\057"
	"\220\222\124\175\032\206\001\371\054\031\144\224\055\127\145\107"
	"\330\010\101\144\166\124\300\316\360\075\133\142\366\322\203\355"
	"\306\032\260\047\252\240\363\271\171\314\316\132\371\266\110\166"
	"\226\130\250\255\216\153\070\344\016\316\044\336\063\150\014\234"
	"\275\365\032\136\202\134\216\003\151\216\175\202\030\060\316\245"
	"\302\267\336\226\360\142\010\113\250\174\256\344\110\231\034\263"
	"\141\376\170\304\024\037\275\207\210\054\233\235\261\264\377\063"
	"\254\016\273\365\332\377\144\244\326\170\103\072\341\337\354\157"
	"\063\137\072\240\135\057\373\362\214\365\205\034\317\057\207\254"
	"\347\315\253\070\031\344\311\204\060\042\236\106\223\345\212\361"
	"\121\360\152\232\231\011\011\235\256\333\061\041\152\017\270\071"
	"\311\050\312\023\241\320\256\264\004\367\120\033\022\252\351\376"
	"\214\354\375\175\223\324\333\352\340\335\022\363\002\350\137\236"
	"\252\263\041\056\257\206\334\225\253\104\334\234\047\213\352\063"
	"\373\123\131\357\177\364\157\071\014\144\263\154\137\010\257\325"
	"\353\047\364\113\073\105\332\007\371\106\071\033\061\017\152\077"
	"\016\112\024\007\324\107\151\235\177\261\143\255\042\117\275\310"
	"\112\222\014\111\161\205\261\010\111\013\365\304\265\376\323\057"
	"\167\010\347\026\366\026\305\245\271\104\350\362\144\125\121\061"
	"\020\223\123\172\006\217\343\316\050\273\315\016\176\055\376\152"
	"\170\026\246\021\146\075\223\320\033\044\340\226\215\304\221\142"
	"\122\236\344\347\315\002\051\300\321\333\144\331\121\035\112\257"
	"\237\051\067\053\366\316\007\033\371\077\241\271\376\153\237\311"
	"\173\024\263\136\036\072\343\323\067\171\370\256\126\343\276\210"
	"\371\243\220\324\172\276\157\260\120\217\176\153\047\226\166\347"
	"\272\225\077\000\367\335\104\136\107\332\363\106\114\303\361\051"
	"\143\323\212\330\367\001\113\305\261\372\356\214\323\014\113\113"
	"\076\105\201\133\374\224\065\213\314\072\234\027\123\377\153\337"
	"\255\104\253\132\241\245\050\214\000\175\374\152\046\304\346\276"
	"\231\267\350\371\174\262\162\230\120\236\057\265\275\345\237\255"
	"\247\067\324\026\171\317\153\157\024\104\376\351\231\002\131\007"
	"\270\046\144\303\375\167\241\150\330\251\234\270\055\250\024\175"
	"\137\320\260\211\011\134\023\021\311\335\315\110\330\324\112\050"
	"\064\150\117\266\037\351\220\050\147\326\044\153\021\017\021\256"
	"\001\044\112\206\151\225\020\201\337\305\104\255\251\065\041\375"
	"\322\255\355\070\372\344\075\023\217\060\273\006\144\057\044\127"
	"\234\073\141\116\051\105\361\237\124\343\155\255\327\004\271\217"
	"\212\271\321\235\333\200\057\257\322\067\074\042\344\071\205\263"
	"\133\056\030\244\160\336\221\336\313\161\216\112\325\012\230\173"
	"\367\056\075\354\077\027\021\124\022\267\060\162\140\253\156\170"
	"\015\151\152\030\017\233\304\051\266\173\060\060\052\055\207\161"
	"\001\333\102\062\163\040\346\343\353\240\174\003\207\054\100\025"
	"\160\263\074\222\012\040\064\133\104\323\020\233\345\022\265\142"
	"\114\352\320\154\270\242\027\301\055\364\032\373\005\363\275\153"
	"\207\147\251\055\353\011\276\054\170\363\073\323\153\334\063\227"
	"\036\306\372\127\052\033\043\056\365\356\105\137\174\164\174\165"
	"\320\366\263\262\230\310\332\156\060\004\121\035\240\245\075\061"
	"\141\326\377\032\120\103\015\260\065\246\011\004\165\161\040\105"
	"\370\152\064\075\042\173\025\343\170\164\172\175\376\353\245\144"
	"\361\127\372\342\277\027\117\126\076\102\016\004\251\072\301\307"
	"\330\123\114\345\137\204\261\064\376\274\215\272\064\024\010\347"
	"\057\034\162\112\017\033\306\066\036\063\114\236\241\354\262\312"
	"\371\066\143\366\000\024\254\316\106\115\317\277\110\076\041\342"
	"\020\244\325\201\036\105\246\227\213\156\230\141\152\036\366\207"
	"\200\326\002\060\326\127\024\046\160\262\154\243\106\212\334\133"
	"\071\151\166\234\223\363\016\075\377\014\164\012\064\067\137\020"
	"\326\217\362\114\134\047\146\273\372\364\145\007\130\002\376\167"
	"\200\205\067\232\153\004\045\257\232\306\142\105\352\044\071\315"
	"\323\161\345\354\143\110\124\376\245\261\106\265\077\075\244\236"
	"\257\376\205\320\225\044\232\165\255\342\005\135\006\131\224\277"
	"\353\244\042\214\052\073\132\052\336\231\336\003\246\304\310\245"
	"\025\252\213\334\041\367\227\114\035\154\314\364\224\335\344\247"
	"\024\324\176\045\210\340\176\121\114\343\204\217\222\176\316\373"
	"\270\130\225\061\241\206\115\361\304\042\377\073\134\057\301\242"
	"\112\244\245\217\267\356\247\135\005\211\340\251\351\347\372\113"
	"\011\264\326\055\041\310\025\025\245\050\270\074\107\261\132\264"
	"\331\370\367\247\212\070\147\037\303\040\132\015\204\150\160\367"
	"\013\260\264\030\204\203\315\371\044\155\321\212\351\376\004\225"
	"\231\004\124\372\221\217\372\243\307\256\223\301\350\075\020\043"
	"\214\142\214\110\147\360\174\317\307\225\006\027\222\310\110\121"
	"\077\206\300\302\060\174\022\024\225\260\367\114\110\163\134\236"
	"\233\244\101\150\025\147\222\052\144\043\255\002\227\336\320\336"
	"\243\330\346\025\041\232\301\332\263\102\021\375\341\046\064\364"
	"\040\033\272\270\021\341\374\217\202\141\237\230\254\213\071\360"
	"\272\220\100\340\324\037\207\075\256\250\335\344\373\012\141\204"
	"\001\074\354\164\054\143\132\070\132\143\044\004\334\360\227\363"
	"\315\367\255\120\321\222\377\324\077\345\042\257\045\376\131\332"
	"\132\071\323\067\322\106\163\216\163\207\007\123\343\057\121\311"
	"\165\267\357\232\330\142\243\210\175\357\050\305\340\131\253\136"
	"\064\306\021\345\343\232\045\072\340\365\143\241\277\171\106\106"
	"\251\002\003\042\067\301\262\063\212\074\357\310\025\200\144\215"
	"\200\003\040\110\254\053\355\352\175\212\326\355\247\163\272\103"
	"\135\064\307\226\116\271\340\167\143\162\275\036\340\336\014\032"
	"\176\313\211\001\272\015\024\362\051\300\031\141\037\260\321\214"
	"\236\337\164\336\205\127\162\102\353\265\355\343\030\071\204\152"
	"\122\217\112\073\016\062\052\003\273\203\055\335\132\026\313\265"
	"\324\112\112\202\337\354\127\361\317\326\125\233\334\262\107\052"
	"\257\175\323\056\115\311\172\314\347\131\123\313\052\121\364\202"
	"\166\006\207\241\305\346\211\310\053\332\151\273\224\222\075\201"
	"\237\244\264\160\012\315\211\073\207\117\166\064\243\377\025\374"
	"\113\050\354\354\264\256\115\132\311\026\075\206\336\231\264\060"
	"\376\023\376\300\161\373\243\374\153\310\151\317\050\237\215\326"
	"\367\133\071\136\050\200\153\076\331\255\122\237\275\123\035\161"
	"\335\224\266\261\136\073\152\307\342\375\241\102\331\144\332\274"
	"\202\366\373\305\366\007\273\345\106\164\374\365\020\222\162\373"
	"\210\254\073\157\134\345\154\017\114\355\266\150\156\027\302\015"
	"\211\315\325\271\301\374\034\147\154\120\203\370\330\250\377\105"
	"\370\330\230\310\263\067\147\042\137\336\312\137\017\054\324\024"
	"\063\330\254\335\065\213\346\061\215\101\131\164\205\152\322\262"
	"\256\263\200\337\200\305\361\204\027\142\364\161\255\113\160\377"
	"\372\071\023\210\070\353\202\143\102\174\305\307\372\067\270\000"
	"\237\371\230\261\127\175\331\242\167\362\363\171\145\343\126\252"
	"\071\271\015\375\037\100\356\320\023\335\211\224\033\015\045\331"
	"\361\140\231\305\054\141\015\003\125\366\054\025\254\274\326\315"
	"\220\054\321\054\102\137\230\301\251\250\107\302\063\025\235\366"
	"\152\312\343\242\260\101\330\241\156\112\064\371\225\327\031\217"
	"\146\223\312\360\270\027\356\163\230\231\376\066\330\052\047\313"
	"\151\154\216\060\161\176\013\023\171\241\075\000\035\237\023\240"
	"\110\044\265\246\350\127\175\124\122\371\322\065\373\030\127\233"
	"\254\163\307\330\051\051\105\151\344\002\336\040\055\034\311\153"
	"\137\036\112\051\343\350\113\062\075\203\077\222\063\123\107\352"
	"\326\001\056\175\065\234\006\005\302\243\331\061\273\264\324\131"
	"\020\007\331\170\036\175\075\330\276\203\363\246\003\031\133\143"
	"\146\101\132\141\115\210\155\012\375\133\337\374\241\317\017\156"
	"\220\161\320\155\336\066\172\251\333\116\215\354\263\154\123\223"
	"\065\234\151\062\066\360\273\262\210\002\045\110\252\213\041\337"
	"\300\125\161\053\330\124\011\375\205\053\175\106\057\354\325\205"
	"\273\060\010\122\213\303\250\245\047\227\263\372\233\220\002\273"
	"\071\130\007\320\236\023\137\165\133\055\114\134\117\223\113\274"
	"\262\115\140\367\312\072\356\220\034\110\064\107\342\116\263\010"
	"\136\354\126\034\367\064\247\236\024\166\046\063\306\114\165\202"
	"\045\144\263\261\232\155\303\043\331\005\106\156\132\242\242\162"
	"\347\266\337\232\042\136\241\317\057\364\266\036\161\160\155\367"
	"\134\303\310\344\316\045\017\040\331\303\315\200\031\160\141\340"
	"\207\250\226\323\222\104\111\035\333\107\025\174\346\245\023\223"
	"\131\350\201\301\232\050\301\177\011\021\005\026\071\030\267\355"
	"\032\165\354\355\231\213\374\233\360\343\360\252\344\052\206\245"
	"\256\074\211\127\301\051\022\260\366\307\164\107\331\263\352\147"
	"\360\307\372\156\241\214\177\154\202\264\225\225\010\314\315\371"
	"\163\235\357\340\245\337\263\044\364\170\264\003\165\352\115\141"
	"\262\376\104\327\110\215\104\304\256\050\376\236\366\202\177\126"
	"\210\171\241\101\007\364\153\175\140\165\352\221\320\165\071\316"
	"\336\003\263\325\026\060\325\317\330\107\046\113\324\064\151\070"
	"\061\174\020\333\041\061\206\330\114\343\345\074\333\002\167\325"
	"\313\167\136\137\004\162\200\264\354\200\265\371\375\212\375\346"
	"\067\130\246\261\030\120\100\252\110\340\310\153\260\055\355\050"
	"\261\347\312\153\301\016\257\143\114\270\267\177\174\000\275\261"
	"\206\375\066\122\035\024\222\270\120\256\101\055\000\207\227\260"
	"\127\353\057\030\026\102\147\325\174\122\131\020\244\274\214\203"
	"\017\206\136\176\363\354\334\171\301\030\015\072\250\124\074\305"
	"\066\055\310\346\123\122\365\026\165\225\310\041\155\034\072\357"
	"\061\214\365\232\124\016\207\060\370\070\134\363\001\346\304\251"
	"\227\022\236\202\074\264\310\324\241\370\106\030\056\124\011\234"
	"\206\355\001\164\077\302\161\342\332\034\347\224\144\344\110\112"
	"\061\237\355\211\072\112\330\352\177\260\252\046\056\141\343\365"
	"\336\262\130\165\237\032\166\062\040\202\372\230\247\230\007\115"
	"\204\111\367\074\331\353\245\333\153\200\027\153\360\251\030\303"
	"\206\016\066\156\006\135\357\013\144\203\141\214\207\107\031\145"
	"\065\016\021\120\167\072\036\250\357\025\313\012\252\153\331\015"
	"\202\377\367\327\267\033\352\232\354\272\022\122\232\151\200\376"
	"\073\064\145\023\106\320\225\003\032\253\120\034\377\230\116\045"
	"\343\043\257\030\026\025\365\310\355\214\336\051\136\273\336\350"
	"\063\130\205\145\226\301\105\005\017\370\067\003\334\244\264\245"
	"\310\006\100\030\205\334\315\344\266\225\050\130\313\352\142\167"
	"\336\266\042\254\153\164\337\206\375\110\066\104\025\335\370\104"
	"\161\222\224\322\140\266\041\307\205\341\007\124\151\003\107\271"
	"\154\170\343\207\271\304\347\343\246\104\055\267\277\306\236\366"
	"\123\336\107\151\377\010\135\303\243\235\035\076\244\025\136\066"
	"\307\036\330\355\040\312\054\312\142\256\277\217\057\052\140\114"
	"\105\016\311\276\024\172\157\175\331\361\377\360\201\077\031\177"
	"\243\233\375\177\063\174\225\310\055\016\040\150\211\216\066\311"
	"\152\066\313\245\122\367\134\000\301\323\375\256\315\366\013\157"
	"\075\056\245\103\117\104\231\034\123\260\273\343\362\101\200\010"
	"\112\347\226\036\143\111\132\311\240\104\344\300\077\035\116\071"
	"\004\066\140\355\355\055\314\004\274\065\343\335\024\210\300\163"
	"\047\037\354\217\325\041\103\061\311\257\171\302\045\261\261\317"
	"\256\304\040\245\360\370\115\201\344\247\007\255\141\075\205\126"
	"\372\047\331\376\011\332\042\116\303\343\002\003\205\242\322\324"
	"\242\075\230\020\257\221\315\242\242\160\050\172\132\067\334\321"
	"\117\143\360\337\246\065\114\172\353\215\110\155\366\153\025\111"
	"\142\302\206\010\352\142\224\273\055\351\327\145\223\041\324\276"
	"\070\161\063\047\077\260\135\052\115\071\205\223\003\074\205\077"
	"\234\362\222\071\241\367\011\134\331\271\065\006\046\117\213\133"
	"\244\245\062\211\012\337\067\331\313\124\375\342\150\131\223\253"
	"\216\256\305\257\216\010\101\000\375\013\361\301\111\031\366\067"
	"\164\025\066\257\150\214\320\350\371\141\312\150\300\277\177\077"
	"\255\326\031\045\324\173\105\012\010\176\224\230\145\277\356\062"
	"\262\161\132\222\356\154\202\154\063\021\132\014\261\067\217\377"
	"\206\312\045\263\010\333\035\340\377\126\253\321\063\301\260\321"
	"\226\045\037\153\100\361\211\162\145\261\233\152\037\107\050\273"
	"\315\367\227\033\247\146\372\142\005\024\374\203\031\275\372\024"
	"\040\142\120\123\353\327\013\066\005\031\057\274\140\044\240\005"
	"\021\343\007\066\043\333\364\243\276\241\351\251\106\311\067\333"
	"\233\064\055\005\050\167\074\071\254\340\120\203\255\031\226\327"
	"\211\035\201\012\003\122\365\041\371\105\225\311\117\047\026\160"
	"\371\001\020\066\336\177\303\233\072\360\115\105\206\352\037\000"
	"\224\243\047\356\070\211\370\111\261\164\024\316\040\073\134\063"
	"\276\354\364\275\310\250\341\116\045\223\327\066\177\232\101\310"
	"\304\124\355\124\265\076\255\375\167\056\034\165\130\025\126\100"
	"\363\331\034\057\365\031\177\032\272\232\221\045\271\107\014\204"
	"\010\077\351\203\126\341\261\063\174\143\233\322\356\271\173\315"
	"\046\250\060\356\067\072\211\011\042\271\127\120\042\214\077\314"
	"\000\207\106\343\223\315\244\146\137\344\350\135\122\025\270\137"
	"\307\077\110\043\361\116\161\152\137\352\365\170\116\356\307\076"
	"\005\231\075\120\231\052\175\364\252\103\334\277\146\156\066\242"
	"\174\215\216\261\310\151\310\205\032\035\044\360\144\154\264\167"
	"\200\233\142\017\213\324\366\074\231\227\211\211\200\220\335\134"
	"\352\166\034\215\210\147\007\223\116\276\245\324\367\303\204\007"
	"\173\255\113\205\343\034\373\037\335\277\333\020\025\101\365\254"
	"\321\371\043\144\170\271\312\342\274\136\253\211\262\161\353\374"
	"\225\206\323\115\074\220\117\352\222\245\300\050\040\135\135\245"
	"\233\335\211\027\100\216\034\251\150\317\037\104\057\372\241\206"
	"\346\175\270\026\306\225\345\217\106\331\347\103\122\223\100\060"
	"\224\331\120\241\006\336\177\314\202\270\011\241\332\244\173\034"
	"\313\252\114\204\373\100\261\011\052\101\036\263\156\330\036\141"
	"\306\253\040\011\324\163\070\051\061\161\241\011\222\003\212\215"
	"\051\012\042\045\375\346\253\316\343\260\002\240\044\032\341\301"
	"\140\046\302\176\013\375\230\257\324\045\315\361\213\140\031\313"
	"\216\330\071\246\153\010\211\112\010\025\274\075\346\147\306\154"
	"\261\230\252\215\316\220\357\020\110\206\203\116\304\173\122\067"
	"\222\222\274\035\177\115\161\101\011\052\024\353\130\302\061\124"
	"\201\331\201\357\156\044\251\110\063\064\344\300\024\103\050\075"
	"\072\317\022\220\225\114\167\256\134\057\077\171\060\312\311\226"
	"\052\103\073\324\132\320\133\315\072\033\240\177\075\017\122\356"
	"\162\276\023\177\272\257\272\132\067\222\145\302\204\331\113\367"
	"\341\041\343\037\043\371\221\106\041\174\356\100\374\047\342\343"
	"\135\077\133\144\356\360\073\002\005\074\352\002\373\154\025\211"
	"\066\143\006\106\273\346\347\005\042\347\355\377\001\060\330\216"
	"\034\146\154\247\343\360\055\252\032\302\361\150\074\306\353\211"
	"\014\351\135\215\176\132\014\336\050\033\130\307\202\251\062\236"
	"\275\314\321\077\326\071\234\016\267\022\204\117\011\045\302\024"
	"\043\343\302\041\271\100\346\216\110\243\357\226\363\117\077\230"
	"\322\105\177\054\206\031\367\250\201\374\014\263\365\233\234\150"
	"\134\154\171\266\125\150\071\351\367\157\060\227\231\252\254\264"
	"\263\372\333\046\154\133\276\250\253\313\374\001\255\066\335\067"
	"\323\004\164\120\037\124\047\217\004\227\363\034\046\023\145\246"
	"\070\252\210\065\044\076\361\004\365\200\274\101\150\207\262\151"
	"\257\360\041\144\145\012\045\255\155\013\034\031\214\123\172\050"
	"\224\060\031\030\007\102\164\274\217\236\251\271\350\252\224\161"
	"\150\033\123\263\164\125\220\377\062\222\136\313\067\354\000\123"
	"\356\223\043\242\354\007\111\352\034\250\033\062\056\134\031\052"
	"\333\365\052\357\025\276\252\022\201\171\200\351\314\230\154\076"
	"\171\074\233\127\343\352\066\344\374\251\024\365\270\271\005\131"
	"\321\243\003\336\117\364\107\032\275\164\153\253\343\373\151\016"
	"\254\165\034\142\054\265\222\124\272\361\117\101\122\224\144\117"
	"\177\301\265\350\147\232\306\013\175\041\171\102\012\041\264\333"
	"\210\062\164\233\363\305\111\200\045\036\012\317\320\373\362\173"
	"\354\156\166\046\105\153\105\375\262\265\057\367\360\240\236\313"
	"\225\222\275\017\206\050\171\065\117\006\025\357\273\035\320\122"
	"\112\250\175\261\001\273\233\326\121\356\352\210\236\347\353\161"
	"\232\063\064\233\116\316\127\016\345\106\062\233\040\040\133\363"
	"\316\166\132\266\030\321\331\153\061\163\005\020\336\106\151\342"
	"\111\061\205\360\101\117\267\046\357\121\052\105\002\114\000\056"
	"\246\313\064\144\225\050\003\331\124\077\164\137\106\306\011\146"
	"\012\170\354\204\203\107\177\145\166\353\317\241\333\006\162\024"
	"\142\202\103\337\376\241\077\200\272\336\276\245\202\275\127\267"
	"\300\176\306\141\363\020\146\152\052\024\144\342\163\210\137\367"
	"\216\040\060\100\171\251\044\101\165\366\305\233\164\274\267\025"
	"\151\166\375\075\310\330\136\063\073\207\216\363\022\061\202\336"
	"\270\103\007\064\222\327\271\247\203\022\356\264\276\126\041\327"
	"\262\010\235\134\310\101\355\273\106\210\122\000\177\211\332\333"
	"\131\325\214\244\034\027\222\344\001\214\105\110\222\034\046\214"
	"\001\017\266\170\370\026\167\123\301\016\251\146\377\042\036\230"
	"\202\322\306\243\104\107\240\203\010\201\364\330\165\070\267\056"
	"\211\134\100\165\247\152\036\063\370\026\055\113\165\235\174\065"
	"\373\315\064\044\172\040\014\350\270\346\016\234\275\164\012\160"
	"\142\007\207\065\161\105\126\121\230\343\262\026\104\266\303\364"
	"\215\054\033\163\151\142\124\220\114\327\136\000\260\220\250\254"
	"\153\274\045\253\230\216\046\324\344\270\037\065\075\361\341\011"
	"\305\204\216\156\076\071\276\061\014\036\071\005\155\211\104\342"
	"\235\045\301\130\340\055\054\100\060\155\047\217\060\106\311\135"
	"\026\164\352\342\174\024\066\025\101\122\151\157\023\364\035\126"
	"\240\274\356\113\023\237\127\251\013\233\170\011\056\204\071\123"
	"\341\266\165\147\036\125\215\150\300\160\021\031\037\327\144\246"
	"\352\174\350\124\312\344\345\346\023\135\345\247\002\221\142\046"
	"\274\364\037\153\277\057\301\136\066\174\173\150\115\233\305\312"
	"\240\211\127\162\204\160\025\354\305\127\153\336\153\313\003\371"
	"\160\123\323\113\114\027\153\325\001\262\124\143\333\051\200\074"
	"\027\260\036\250\334\005\056\112\307\371\275\167\050\327\230\130"
	"\156\317\102\115\065\062\110\011\052\160\302\246\215\161\040\201"
	"\171\242\354\111\105\372\310\327\164\261\231\144\046\177\337\056"
	"\037\252\207\163\134\300\153\356\151\172\113\233\335\060\222\121"
	"\307\261\234\214\123\034\150\150\163\274\256\060\217\212\310\141"
	"\253\224\143\077\304\240\370\263\054\327\306\330\101\123\061\045"
	"\106\076\272\325\075\115\012\073\154\154\360\240\101\157\076\037"
	"\053\147\172\323\125\350\115\117\206\172\305\202\244\350\146\243"
	"\106\230\056\224\155\105\277\222\013\205\046\262\072\222\117\057"
	"\023\154\165\115\023\014\027\357\066\341\002\253\203\066\305\157"
	"\353\247\275\317\321\131\225\346\132\234\352\074\311\222\362\333"
	"\215\354\270\164\026\232\245\361\351\012\137\243\012\111\205\331"
	"\017\353\370\321\344\377\240\231\264\153\061\374\001\264\063\251"
	"\042\312\057\073\222\211\062\365\333\076\060\230\236\114\122\346"
	"\204\157\046\304\151\327\045\040\334\136\270\363\041\134\375\273"
	"\073\242\123\066\267\331\241\363\047\112\267\055\050\102\270\313"
	"\167\013\235\047\335\244\340\147\213\153\157\136\202\105\047\346"
	"\146\050\341\047\336\253\047\176\360\317\243\117\115\305\011\313"
	"\101\342\162\340\117\132\324\047\276\123\240\343\040\130\241\316"
	"\233\205\160\270\042\150\021\331\174\032\301\005\242\175\365\061"
	"\314\360\313\346\151\342\361\036\136\175\153\222\021\246\154\211"
	"\041\134\053\131\007\145\036\321\063\223\210\372\051\375\264\217"
	"\241\242\262\166\251\162\163\240\111\316\110\163\134\126\145\230"
	"\221\045\010\324\066\113\177\267\157\360\014\105\031\356\316\145"
	"\060\176\307\327\272\316\252\350\010\252\077\031\334\345\113\052"
	"\030\263\011\263\070\353\213\106\176\025\232\260\004\151"
#define      msg1_z	65
#define      msg1	((&data[6813]))
	"\334\013\243\315\362\113\142\345\163\153\152\300\056\022\210\130"
	"\156\135\043\302\000\303\335\266\174\156\075\273\236\253\074\231"
	"\001\370\235\053\120\363\264\357\246\344\052\126\361\067\236\072"
	"\334\046\002\315\324\027\023\373\332\320\116\142\360\353\037\330"
	"\310\344\124\134\253\266\214\263\140\313\314\075\261\030\150\312"
	"\313\161\175"
#define      date_z	1
#define      date	((&data[6893]))
	"\337"
#define      xecc_z	15
#define      xecc	((&data[6897]))
	"\345\213\042\023\365\225\226\053\175\046\142\374\317\365\236\325"
	"\217\032"
#define      tst1_z	22
#define      tst1	((&data[6915]))
	"\067\176\142\265\111\056\217\364\250\246\337\220\255\050\107\112"
	"\323\304\074\363\224\043\226\042\012\332\052"
#define      shll_z	10
#define      shll	((&data[6940]))
	"\171\316\135\150\326\063\051\240\154\202\123\062\252"
#define      tst2_z	19
#define      tst2	((&data[6956]))
	"\037\256\217\220\101\262\156\021\033\053\113\027\113\157\015\167"
	"\175\045\322\317\122\067\335\054\223\355"
#define      chk2_z	19
#define      chk2	((&data[6982]))
	"\123\304\125\165\137\262\027\354\136\350\117\304\353\112\107\134"
	"\233\052\110\257\261\357\261\023\367\314"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define HARDENINGSP	0	/* Define as 1 to disable bash child process */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a processs */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;

    int lentmp = len;

#if HARDENINGSP
    //Start tracing to protect from dump & trace
    if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }

    //Decode Bash
    while (len > 0) {
        indx++;
        tmp = stte[indx];
        jndx += tmp;
        stte[indx] = stte[jndx];
        stte[jndx] = tmp;
        tmp += stte[indx];
        *ptr ^= stte[tmp];
        ptr++;
        len--;
    }

    //Exec bash script
    system(tmp2);

    //Empty script variable
    memcpy(tmp2, str, lentmp);

    //Sinal to detach ptrace
    ptrace(PTRACE_DETACH, 0, 0, 0);
    exit(0);

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
#endif /* HARDENINGSP Exit here anyway*/

    int pid, status;
    pid = fork();

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            printf("Operation not permitted\n");
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Exec bash script
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {
        wait(&status);
    }

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
} 
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
